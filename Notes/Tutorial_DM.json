{"paragraphs":[{"text":"%md\nimport data","user":"anonymous","dateUpdated":"2025-06-19T03:11:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>import data</p>\n"}]},"apps":[],"jobName":"paragraph_1750301587702_-1452418359","id":"20250619-025307_869320100","dateCreated":"2025-06-19T02:53:07+0000","dateStarted":"2025-06-19T03:11:31+0000","dateFinished":"2025-06-19T03:11:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1686"},{"text":"%sh\r\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.user -O /tmp/u.user","user":"anonymous","dateUpdated":"2025-06-19T03:18:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-06-19 03:18:15--  http://media.sundog-soft.com/hadoop/ml-100k/u.user\nResolving media.sundog-soft.com (media.sundog-soft.com)... 54.231.236.193, 52.217.10.20, 52.217.197.177, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|54.231.236.193|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K) [text/plain]\nSaving to: ‘/tmp/u.user’\n\n     0K .......... .......... ..                              100% 91.5K=0.2s\n\n2025-06-19 03:18:16 (91.5 KB/s) - ‘/tmp/u.user’ saved [22628/22628]\n\n"}]},"apps":[],"jobName":"paragraph_1750297988083_683899418","id":"20250619-015308_300785967","dateCreated":"2025-06-19T01:53:08+0000","dateStarted":"2025-06-19T03:18:14+0000","dateFinished":"2025-06-19T03:18:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1687"},{"text":"%md\nload data from HDP","user":"anonymous","dateUpdated":"2025-06-19T03:13:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750302749960_-648067705","id":"20250619-031229_1473817857","dateCreated":"2025-06-19T03:12:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2724","dateFinished":"2025-06-19T03:13:21+0000","dateStarted":"2025-06-19T03:13:21+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>load data from HDP</p>\n"}]}},{"text":"%pyspark\r\n\r\n# Load raw text file\r\nraw_rdd = sc.textFile(\"/tmp/ml-100k/iris\")  # or HDFS path\r\nraw_rdd.take(5)\r\n\r\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[u'5.1,3.5,1.4,0.2,Iris-setosa', u'4.9,3.0,1.4,0.2,Iris-setosa', u'4.7,3.2,1.3,0.2,Iris-setosa', u'4.6,3.1,1.5,0.2,Iris-setosa', u'5.0,3.6,1.4,0.2,Iris-setosa']\n"}]},"apps":[],"jobName":"paragraph_1750298591288_876314907","id":"20250619-020311_299442136","dateCreated":"2025-06-19T02:03:11+0000","dateStarted":"2025-06-19T03:18:27+0000","dateFinished":"2025-06-19T03:18:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1688"},{"text":"%pyspark\r\n# Split by comma and convert to Row\r\nfrom pyspark.sql import Row\r\n\r\niris_rdd = raw_rdd.map(lambda line: line.split(\",\")) \\\r\n    .map(lambda parts: Row(\r\n        sepal_length=float(parts[0]),\r\n        sepal_width=float(parts[1]),\r\n        petal_length=float(parts[2]),\r\n        petal_width=float(parts[3]),\r\n        species=parts[4]\r\n    ))\r\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1750299894108_-218363359","id":"20250619-022454_191920876","dateCreated":"2025-06-19T02:24:54+0000","dateStarted":"2025-06-19T03:18:31+0000","dateFinished":"2025-06-19T03:18:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1689"},{"text":"%md\n","user":"anonymous","dateUpdated":"2025-06-19T03:14:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750302845879_-1471476324","id":"20250619-031405_1596405674","dateCreated":"2025-06-19T03:14:05+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2819"},{"text":"%pyspark\niris_df = spark.createDataFrame(iris_rdd)\niris_df.show(5)\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+------------+-----------+-----------+\n|petal_length|petal_width|sepal_length|sepal_width|    species|\n+------------+-----------+------------+-----------+-----------+\n|         1.4|        0.2|         5.1|        3.5|Iris-setosa|\n|         1.4|        0.2|         4.9|        3.0|Iris-setosa|\n|         1.3|        0.2|         4.7|        3.2|Iris-setosa|\n|         1.5|        0.2|         4.6|        3.1|Iris-setosa|\n|         1.4|        0.2|         5.0|        3.6|Iris-setosa|\n+------------+-----------+------------+-----------+-----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1750300080517_-1734965258","id":"20250619-022800_1086521986","dateCreated":"2025-06-19T02:28:00+0000","dateStarted":"2025-06-19T03:18:35+0000","dateFinished":"2025-06-19T03:18:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1690"},{"text":"%pyspark\r\ndef is_valid(row):\r\n    parts = row.split(\",\")\r\n    return len(parts) == 5 and all(p.replace(\".\", \"\", 1).isdigit() for p in parts[:4])\r\n\r\nclean_rdd = raw_rdd.filter(is_valid)\r\n\r\niris_rdd = clean_rdd.map(lambda line: line.split(\",\")) \\\r\n    .map(lambda parts: Row(\r\n        sepal_length=float(parts[0]),\r\n        sepal_width=float(parts[1]),\r\n        petal_length=float(parts[2]),\r\n        petal_width=float(parts[3]),\r\n        species=parts[4]\r\n    ))\r\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1750300091772_2005609521","id":"20250619-022811_1384334278","dateCreated":"2025-06-19T02:28:11+0000","dateStarted":"2025-06-19T03:18:47+0000","dateFinished":"2025-06-19T03:18:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1691"},{"text":"%pyspark\r\niris_df = spark.createDataFrame(iris_rdd)\r\niris_df.show(5)","user":"anonymous","dateUpdated":"2025-06-19T03:18:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+-----------+------------+-----------+-----------+\n|petal_length|petal_width|sepal_length|sepal_width|    species|\n+------------+-----------+------------+-----------+-----------+\n|         1.4|        0.2|         5.1|        3.5|Iris-setosa|\n|         1.4|        0.2|         4.9|        3.0|Iris-setosa|\n|         1.3|        0.2|         4.7|        3.2|Iris-setosa|\n|         1.5|        0.2|         4.6|        3.1|Iris-setosa|\n|         1.4|        0.2|         5.0|        3.6|Iris-setosa|\n+------------+-----------+------------+-----------+-----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1750300156786_1797319160","id":"20250619-022916_1362955699","dateCreated":"2025-06-19T02:29:16+0000","dateStarted":"2025-06-19T03:18:49+0000","dateFinished":"2025-06-19T03:18:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1692"},{"text":"%pyspark\r\nfrom pyspark.ml.feature import StringIndexer\r\n\r\nindexer = StringIndexer(inputCol=\"species\", outputCol=\"label\")\r\nindexed_df = indexer.fit(iris_df).transform(iris_df)\r\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1750300917161_1242196016","id":"20250619-024157_1508032118","dateCreated":"2025-06-19T02:41:57+0000","dateStarted":"2025-06-19T03:18:51+0000","dateFinished":"2025-06-19T03:18:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1693"},{"text":"%pyspark\nfrom pyspark.ml.feature import VectorAssembler\n\nassembler = VectorAssembler(\n    inputCols=[\"sepal_length\", \"sepal_width\", \"petal_length\", \"petal_width\"],\n    outputCol=\"features\"\n)\n\nfinal_df = assembler.transform(indexed_df).select(\"features\", \"label\")\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1750301026361_817618765","id":"20250619-024346_1235876723","dateCreated":"2025-06-19T02:43:46+0000","dateStarted":"2025-06-19T03:18:54+0000","dateFinished":"2025-06-19T03:18:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1694"},{"text":"%pyspark\ntrain_data, test_data = final_df.randomSplit([0.7, 0.3], seed=12)\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1750301039484_-882586625","id":"20250619-024359_1102025591","dateCreated":"2025-06-19T02:43:59+0000","dateStarted":"2025-06-19T03:18:57+0000","dateFinished":"2025-06-19T03:18:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1695"},{"text":"%pyspark\nfrom pyspark.ml.classification import RandomForestClassifier\n\nrf = RandomForestClassifier(labelCol=\"label\", featuresCol=\"features\")\nmodel = rf.fit(train_data)\n","user":"anonymous","dateUpdated":"2025-06-19T03:18:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1750301061637_1693737983","id":"20250619-024421_1510375026","dateCreated":"2025-06-19T02:44:21+0000","dateStarted":"2025-06-19T03:18:59+0000","dateFinished":"2025-06-19T03:19:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1696"},{"text":"%pyspark\npredictions","user":"anonymous","dateUpdated":"2025-06-19T03:17:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750303040696_-359279980","id":"20250619-031720_1804597216","dateCreated":"2025-06-19T03:17:20+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2887","dateFinished":"2025-06-19T03:17:54+0000","dateStarted":"2025-06-19T03:17:30+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-2309491045826910636.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-2309491045826910636.py\", line 360, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'predictions' is not defined\n\n"}]}},{"text":"%pyspark\npredictions = model.transform(test_data)\npredictions.select(\"features\", \"label\", \"prediction\").show(5)","user":"anonymous","dateUpdated":"2025-06-19T03:19:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-----+----------+\n|         features|label|prediction|\n+-----------------+-----+----------+\n|[4.4,3.2,1.3,0.2]|  2.0|       2.0|\n|[4.6,3.1,1.5,0.2]|  2.0|       2.0|\n|[4.6,3.2,1.4,0.2]|  2.0|       2.0|\n|[4.6,3.6,1.0,0.2]|  2.0|       2.0|\n|[4.7,3.2,1.3,0.2]|  2.0|       2.0|\n+-----------------+-----+----------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1750301074014_-1911343887","id":"20250619-024434_1644908379","dateCreated":"2025-06-19T02:44:34+0000","dateStarted":"2025-06-19T03:19:07+0000","dateFinished":"2025-06-19T03:19:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1697"},{"text":"%pyspark\npredictions.show(5)","user":"anonymous","dateUpdated":"2025-06-19T03:19:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750303083001_1206910199","id":"20250619-031803_780848872","dateCreated":"2025-06-19T03:18:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2973","dateFinished":"2025-06-19T03:19:23+0000","dateStarted":"2025-06-19T03:19:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+-----+--------------+-------------+----------+\n|         features|label| rawPrediction|  probability|prediction|\n+-----------------+-----+--------------+-------------+----------+\n|[4.4,3.2,1.3,0.2]|  2.0|[0.0,0.0,20.0]|[0.0,0.0,1.0]|       2.0|\n|[4.6,3.1,1.5,0.2]|  2.0|[0.0,0.0,20.0]|[0.0,0.0,1.0]|       2.0|\n|[4.6,3.2,1.4,0.2]|  2.0|[0.0,0.0,20.0]|[0.0,0.0,1.0]|       2.0|\n|[4.6,3.6,1.0,0.2]|  2.0|[0.0,0.0,20.0]|[0.0,0.0,1.0]|       2.0|\n|[4.7,3.2,1.3,0.2]|  2.0|[0.0,0.0,20.0]|[0.0,0.0,1.0]|       2.0|\n+-----------------+-----+--------------+-------------+----------+\nonly showing top 5 rows\n\n"}]}},{"text":"%pyspark\nfrom pyspark.ml.evaluation import MulticlassClassificationEvaluator\n\nevaluator = MulticlassClassificationEvaluator(labelCol=\"label\", predictionCol=\"prediction\", metricName=\"accuracy\")\naccuracy = evaluator.evaluate(predictions)\nprint(\"Accuracy: {:.3f}\".format(accuracy))\n","user":"anonymous","dateUpdated":"2025-06-19T02:47:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Accuracy: 0.957\n"}]},"apps":[],"jobName":"paragraph_1750301100410_1480849248","id":"20250619-024500_1730661405","dateCreated":"2025-06-19T02:45:00+0000","dateStarted":"2025-06-19T02:47:53+0000","dateFinished":"2025-06-19T02:47:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1698"},{"text":"%pyspark\nf1= evaluator.setMetricName(\"f1\").evaluate(predictions)\nprecision= evaluator.setMetricName(\"weightedPrecision\").evaluate(predictions)\nrecall= evaluator.setMetricName(\"weightedRecall\").evaluate(predictions)\nprint(\"F1-Score: {:.3f}\".format(f1))\nprint(\"Precision: {:.3f}\".format(precision))\nprint(\"Recall: {:.3f}\".format(recall))","user":"anonymous","dateUpdated":"2025-06-19T02:51:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"F1-Score: 0.957\nPrecision: 0.957\nRecall: 0.957\n"}]},"apps":[],"jobName":"paragraph_1750301137869_-1105017462","id":"20250619-024537_913203382","dateCreated":"2025-06-19T02:45:37+0000","dateStarted":"2025-06-19T02:51:02+0000","dateFinished":"2025-06-19T02:51:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1699"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2025-06-19T02:48:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1750301280655_2047243957","id":"20250619-024800_1003018981","dateCreated":"2025-06-19T02:48:00+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:1700"}],"name":"Tutorial_DM","id":"2KXG41EYM","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}